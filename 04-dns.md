# Proxy

## Installation

Start vm
```
[root@lab mylab]# virsh start proxy
Domain 'proxy' started

[root@lab mylab]# virsh domstate proxy
running

[root@lab mylab]# virsh dumpxml proxy | grep vnc
    <graphics type='vnc' port='5901' autoport='yes' listen='127.0.0.1'>
```

```
[root@lab centos]# ansible-playbook -i inventory playbooks/bind.yaml

PLAY [Quay] *******************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ********************************************************************************************************************************************************************************************
ok: [bind]

TASK [bind : install bind] ****************************************************************************************************************************************************************************************
changed: [bind]

TASK [bind : delete named.conf] ***********************************************************************************************************************************************************************************
changed: [bind]

TASK [bind : push name.conf] **************************************************************************************************************************************************************************************
changed: [bind]

TASK [bind : push forward] ****************************************************************************************************************************************************************************************
changed: [bind] => (item={'name': 'monlab.local', 'def': [{'name': 'bind', 'record': 'A', 'ip': '172.17.1.40'}, {'name': 'quay', 'record': 'A', 'ip': '172.17.1.50'}]})

TASK [bind : push reverse] ****************************************************************************************************************************************************************************************
changed: [bind] => (item={'name': '1.17.172.in-addr.arpa', 'def': [{'name': 'bind', 'record': 'PTR', 'last_digit': 40}, {'name': 'quay', 'record': 'PTR', 'last_digit': 50}]})

TASK [bind : restart named] ***************************************************************************************************************************************************************************************
changed: [bind]

PLAY RECAP ********************************************************************************************************************************************************************************************************
bind                       : ok=7    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
```

## Check
```
[root@proxy ~]# nslookup quay.monlab.local
Server:         172.17.1.30
Address:        172.17.1.30#53

Name:   quay.monlab.local
Address: 172.17.1.50

[root@proxy ~]# host quay.monlab.local 172.17.1.30
Using domain server:
Name: 172.17.1.30
Address: 172.17.1.30#53
Aliases: 

quay.monlab.local has address 172.17.1.50


```
